{% extends "base.html" %}

{% block content %}

    {# ページタイトル: フォームインスタンス（カテゴリID）の有無で表示を切り替える #}
    <h2>カテゴリの{% if form.instance.pk %}編集{% else %}新規作成{% endif %}</h2>

    <form method="post">
        {% csrf_token %}
        
        {# ============================================================================== #}
        {# 💡 重要: リダイレクト先URLを保持する hidden フィールド #}
        {# これにより、保存ボタン（POST送信）を押した後も View が戻り先を把握できます #}
        {# ============================================================================== #}
        <input type="hidden" name="next" value="{{ next_url }}">

        {# ============================================================================== #}
        {# 1. カテゴリ名フィールドのレンダリング #}
        {# ============================================================================== #}
        <div class="mb-3 col-md-4">
            <label for="{{ form.name.id_for_label }}" class="form-label">{{ form.name.label }}</label>
            
            {# カテゴリ名入力フィールドを直接レンダリング #}
            {{ form.name }}
            
            {# フィールドのエラーメッセージを表示 #}
            {% for error in form.name.errors %}
                <div class="alert alert-danger mt-1 small">{{ error }}</div>
            {% endfor %}
        </div>
        
        {# ============================================================================== #}
        {# 2. 送信/キャンセルボタン #}
        {# ============================================================================== #}
        <div class="mt-4">
            <button type="submit" class="btn btn-success">保存</button>
            
            {# キャンセルボタンのリンク先制御 #}
            {# View から渡された next_url をそのまま使用します #}
            <a href="{{ next_url }}" class="btn btn-secondary">
                キャンセル
            </a>
        </div>
    </form>

{% endblock content %}